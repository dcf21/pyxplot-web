<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>3.9 Numerical Integration and Differentiation</TITLE>
<META NAME="description" CONTENT="3.9 Numerical Integration and Differentiation">
<META NAME="keywords" CONTENT="pyxplot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="pyxplot.css">

<LINK REL="next" HREF="node44.html">
<LINK REL="previous" HREF="node42.html">
<LINK REL="up" HREF="node21.html">
<LINK REL="next" HREF="node44.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1023"
  HREF="node44.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1017"
  HREF="node21.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1011"
  HREF="node42.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1019"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1021"
  HREF="node179.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1024"
  HREF="node44.html">3.10 Script Watching: pyxplot_watch</A>
<B> Up:</B> <A NAME="tex2html1018"
  HREF="node21.html">3. Extensions of Gnuplot's</A>
<B> Previous:</B> <A NAME="tex2html1012"
  HREF="node42.html">3.8 Datafile Interpolation: Spline</A>
 &nbsp; <B>  <A NAME="tex2html1020"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1022"
  HREF="node179.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00490000000000000000">
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">9</SPAN> Numerical Integration and Differentiation</A>
</H1>

<P>
Special functions are available for performing numerical integration and
differentiation of expressions: <TT>int_dx()</TT> and
<TT>diff_dx()</TT><A NAME="1100"></A><A NAME="1101"></A><A NAME="3223"></A><A NAME="3224"></A>. In each case, the ``<TT>x</TT>'' may be
replaced with any valid variable name, to integrate or differentiate with
respect to any given variable.

<P>
The function <TT>int_dx()</TT> takes three parameters - firstly the
expression to be integrated, followed by the minimum and maximum integration
limits. For example, the following would plot the integral of the function
<SPAN CLASS="MATH"><IMG
 WIDTH="49" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$ \sin(x)$"></SPAN>:

<P>
<PRE>
plot int_dt(sin(t),0,x)
</PRE> 

<P>
The function <TT>diff_dx()</TT> takes two parameters and an optional third -
firstly the expression to be differentiated, then the point at which the
differential should be evaluated, and then an optional parameter, <SPAN CLASS="MATH"><IMG
 WIDTH="11" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img74.png"
 ALT="$ \epsilon$"></SPAN>.
The following example would evaluate the differential of the function <SPAN CLASS="MATH"><IMG
 WIDTH="51" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img61.png"
 ALT="$ \cos(x)$"></SPAN>
with respect to <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img9.png"
 ALT="$ x$"></SPAN> at <SPAN CLASS="MATH"><IMG
 WIDTH="60" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img75.png"
 ALT="$ x=1.0$"></SPAN>:

<P>
<PRE>
print diff_dx(cos(x), 1.0)
</PRE>

<P>
Differentials are evaluated by a simple differencing algorithm, and the
parameter <SPAN CLASS="MATH"><IMG
 WIDTH="11" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img74.png"
 ALT="$ \epsilon$"></SPAN> controls the spacing with which to perform the
differencing operation:

<P>
<!-- MATH
 \begin{displaymath}
\left.\frac{\mathrm{d}f}{\mathrm{d}x}\right|_{x=x_0} \approx \frac{f(x_0+\epsilon/2) - f(x_0-\epsilon/2)}{\epsilon}
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<IMG
 WIDTH="292" HEIGHT="59" ALIGN="MIDDLE" BORDER="0"
 SRC="img76.png"
 ALT="$\displaystyle \left.\frac{\mathrm{d}f}{\mathrm{d}x}\right\vert _{x=x_0} \approx \frac{f(x_0+\epsilon/2) - f(x_0-\epsilon/2)}{\epsilon}
$">
</DIV><P></P>

<P>
By default, <!-- MATH
 $\epsilon = 10^{-6}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="70" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img77.png"
 ALT="$ \epsilon = 10^{-6}$"></SPAN>.

<P>
Advanced users may be interested to know that integration is performed using
the <TT>quad</TT> function of the <TT>integrate</TT> package of the
<TT>scipy</TT> numerical toolkit for Python - a general purpose integration
routine.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1023"
  HREF="node44.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1017"
  HREF="node21.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1011"
  HREF="node42.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1019"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1021"
  HREF="node179.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1024"
  HREF="node44.html">3.10 Script Watching: pyxplot_watch</A>
<B> Up:</B> <A NAME="tex2html1018"
  HREF="node21.html">3. Extensions of Gnuplot's</A>
<B> Previous:</B> <A NAME="tex2html1012"
  HREF="node42.html">3.8 Datafile Interpolation: Spline</A>
 &nbsp; <B>  <A NAME="tex2html1020"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1022"
  HREF="node179.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Dominic Ford, 24 November 2006
</ADDRESS>
</BODY>
</HTML>
