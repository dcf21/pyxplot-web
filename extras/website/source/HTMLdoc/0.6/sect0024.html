<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type" />
<title>: Numerical Integration and Differentiation</title>

<link href="sect0025.html" title="Script Watching: pyxplot_watch" rel="next" />
<link href="spline_command.html" title="Datafile Interpolation: Spline Fitting" rel="prev" />
<link href="new_features.html" title="Extensions of Gnuplot’s Interface" rel="up" />
<link rel="stylesheet" href="styles/plastex-styles.css" />
<link rel="stylesheet" href="styles/styles.css" />
</head>
<body>

<div class="navigation">
<table cellspacing="2" cellpadding="0" width="100%">
<tr>
<td><a href="spline_command.html" title="Datafile Interpolation: Spline Fitting"><img alt="Previous: Datafile Interpolation: Spline Fitting" border="0" src="icons/previous.gif" width="32" height="32" /></a></td>

<td><a href="new_features.html" title="Extensions of Gnuplot’s Interface"><img alt="Up: Extensions of Gnuplot’s Interface" border="0" src="icons/up.gif" width="32" height="32" /></a></td>

<td><a href="sect0025.html" title="Script Watching: pyxplot_watch"><img alt="Next: Script Watching: pyxplot_watch" border="0" src="icons/next.gif" width="32" height="32" /></a></td>

<td class="navtitle" align="center"></td>
<td><a href="index.html" title="Table of Contents"><img border="0" alt="" src="icons/contents.gif" width="32" height="32" /></a></td>

<td><a href="sect0124.html" title="Index"><img border="0" alt="" src="icons/index.gif" width="32" height="32" /></a></td>

<td><img border="0" alt="" src="icons/blank.gif" width="32" height="32" /></td>
</tr>
</table>
</div>

<div class="breadcrumbs">
<span>
<span>
<a href="index.html"></a> <b>:</b>
</span>

</span><span>
<span>
<a href="new_features.html">Extensions of Gnuplot’s Interface</a> <b>:</b>
</span>

</span><span>

<span>
<b class="current">Numerical Integration and Differentiation</b>
</span>
</span>
<hr />
</div>

<div><h1 id="a-1228326868">3.9 Numerical Integration and Differentiation</h1>
<p>Special functions are available for performing numerical integration and differentiation of expressions: <tt class="ttfamily">int_dx()</tt> and <tt class="ttfamily">diff_dx()</tt><span id="a-1228293908"></span><span id="a-1227958132"></span><span id="a-1227958676"></span><span id="a-1228209140"></span>. In each case, the “<tt class="ttfamily">x</tt>” may be replaced with any valid variable name, to integrate or differentiate with respect to any given variable. </p><p>The function <tt class="ttfamily">int_dx()</tt> takes three parameters – firstly the expression to be integrated, followed by the minimum and maximum integration limits. For example, the following would plot the integral of the function <img src="images/img-0003.png" alt="$\sin (x)$" style="position:relative; bottom:-5px; width:45px; height:19px" class="math" />: </p><pre>
plot int_dt(sin(t),0,x)
</pre><p>The function <tt class="ttfamily">diff_dx()</tt> takes two obligatory parameters plus two further optional parameters. The first is the expression to be differentiated, followed by the point at which the differential should be evaluated, following by optional parameters <img src="images/img-0086.png" alt="$\epsilon _1$" style="position:relative; bottom:-2px; width:13px; height:10px" class="math" /> and <img src="images/img-0087.png" alt="$\epsilon _2$" style="position:relative; bottom:-2px; width:14px; height:10px" class="math" />, which are described below. The following example would evaluate the differential of the function <img src="images/img-0066.png" alt="$\cos (x)$" style="position:relative; bottom:-5px; width:48px; height:19px" class="math" /> with respect to <img src="images/img-0004.png" alt="$x$" style="position:relative; bottom:-1px; width:10px; height:9px" class="math" /> at <img src="images/img-0088.png" alt="$x=1.0$" style="position:relative; bottom:-1px; width:58px; height:14px" class="math" />: </p><pre>
print diff_dx(cos(x), 1.0)
</pre><p>Differentials are evaluated by a simple differencing algorithm, and a parameter <img src="images/img-0089.png" alt="$\epsilon $" style="position:relative; bottom:-1px; width:7px; height:9px" class="math" /> controls the spacing with which to perform the differencing operation: </p><table id="a-1227581780" class="equation" width="100%">
<tr>
<td>
<img src="images/img-0090.png" alt="\[  \left.\frac{\mathrm{d}f}{\mathrm{d}x}\right|_{x=x_0} \approx \frac{f(x_0+\epsilon /2) - f(x_0-\epsilon /2)}{\epsilon }  \]" style="width:295px; height:49px" />
<td class="eqnnum"></td>
</tr>
</table><p>where <img src="images/img-0091.png" alt="$\epsilon = \epsilon _1 + x \epsilon _2$" style="position:relative; bottom:-2px; width:93px; height:13px" class="math" />. By default, <img src="images/img-0092.png" alt="$\epsilon _1 = \epsilon _2 = 10^{-6}$" style="position:relative; bottom:-2px; width:115px; height:18px" class="math" />, which is appropriate for the differentiation of most well-behaved functions. </p><p>Advanced users may be interested to know that integration is performed using the <tt class="ttfamily">quad</tt> function of the <tt class="ttfamily">integrate</tt> package of the <tt class="ttfamily">scipy</tt> numerical toolkit for Python – a general purpose integration routine. </p></div>



<div class="navigation">
<table cellspacing="2" cellpadding="0" width="100%">
<tr>
<td><a href="spline_command.html" title="Datafile Interpolation: Spline Fitting"><img alt="Previous: Datafile Interpolation: Spline Fitting" border="0" src="icons/previous.gif" width="32" height="32" /></a></td>

<td><a href="new_features.html" title="Extensions of Gnuplot’s Interface"><img alt="Up: Extensions of Gnuplot’s Interface" border="0" src="icons/up.gif" width="32" height="32" /></a></td>

<td><a href="sect0025.html" title="Script Watching: pyxplot_watch"><img alt="Next: Script Watching: pyxplot_watch" border="0" src="icons/next.gif" width="32" height="32" /></a></td>

<td class="navtitle" align="center"></td>
<td><a href="index.html" title="Table of Contents"><img border="0" alt="" src="icons/contents.gif" width="32" height="32" /></a></td>

<td><a href="sect0124.html" title="Index"><img border="0" alt="" src="icons/index.gif" width="32" height="32" /></a></td>

<td><img border="0" alt="" src="icons/blank.gif" width="32" height="32" /></td>
</tr>
</table>
</div>

<script language="javascript" src="icons/imgadjust.js" type="text/javascript"></script>

</body>
</html>
