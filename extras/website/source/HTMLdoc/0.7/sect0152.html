<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta name="generator" content="plasTeX" />
<meta content="text/html; charset=utf-8" http-equiv="content-type" />
<title>: Estimating the Error in </title>

<link href="sect0153.html" title="The Covariance Matrix" rel="next" />
<link href="bayes_pdf.html" title="The Probability Density Function" rel="prev" />
<link href="fit_math.html" title="The &lt;tt class=&quot;tt&quot;&gt;fit&lt;/tt&gt; Command: Mathematical Details" rel="up" />
<link rel="stylesheet" href="styles/styles.css" />
</head>
<body>

<div class="navigation">
<table cellspacing="2" cellpadding="0" width="100%">
<tr>
<td><a href="bayes_pdf.html" title="The Probability Density Function"><img alt="Previous: The Probability Density Function" border="0" src="icons/previous.gif" width="32" height="32" /></a></td>

<td><a href="fit_math.html" title="The fit Command: Mathematical Details"><img alt="Up: The fit Command: Mathematical Details" border="0" src="icons/up.gif" width="32" height="32" /></a></td>

<td><a href="sect0153.html" title="The Covariance Matrix"><img alt="Next: The Covariance Matrix" border="0" src="icons/next.gif" width="32" height="32" /></a></td>

<td class="navtitle" align="center">&nbsp;</td>
<td><a href="index.html" title="Table of Contents"><img border="0" alt="" src="icons/contents.gif" width="32" height="32" /></a></td>

<td><a href="sect0158.html" title="Index"><img border="0" alt="" src="icons/index.gif" width="32" height="32" /></a></td>

<td><img border="0" alt="" src="icons/blank.gif" width="32" height="32" /></td>
</tr>
</table>
</div>

<div class="breadcrumbs">
<span>
<span>
<a href="index.html"></a> <b>:</b>
</span>

</span><span>
<span>
<a href="fit_math.html">The <tt class="tt">fit</tt> Command: Mathematical Details</a> <b>:</b>
</span>

</span><span>

<span>
<b class="current">Estimating the Error in <img src="images/img-0149.png" alt="$\mathbf{u}^0$" style="position:relative; bottom:0px; width:19px; height:16px" class="math" /></b>
</span>
</span>
<hr />
</div>

<div><h1 id="a0000000163">D.3 Estimating the Error in <img src="images/img-0149.png" alt="$\mathbf{u}^0$" style="position:relative; bottom:0px; width:19px; height:16px" class="math" /></h1>
<p>To estimate the error in the best-fitting parameter values that we find, we assume <img src="images/img-0141.png" alt="$\mathrm{P}\left( \mathbf{u} | \left\{  \mathbf{x}_ i, f_ i, \sigma _ i \right\}  \right)$" style="position:relative; bottom:-5px; width:130px; height:19px" class="math" /> to be approximated by an <img src="images/img-0137.png" alt="$n_\mathrm {u}$" style="position:relative; bottom:-2px; width:19px; height:10px" class="math" />-dimensional Gaussian distribution around <img src="images/img-0149.png" alt="$\mathbf{u}^0$" style="position:relative; bottom:0px; width:19px; height:16px" class="math" />. Taking a Taylor expansion of <img src="images/img-0150.png" alt="$L(\mathbf{u})$" style="position:relative; bottom:-4px; width:37px; height:18px" class="math" /> about <img src="images/img-0149.png" alt="$\mathbf{u}^0$" style="position:relative; bottom:0px; width:19px; height:16px" class="math" />, we can write: </p><table id="&lt;plasTeX.TeXFragment object at 0x36b6460&gt;" cellpadding="7" width="100%" cellspacing="0" class="eqnarray">
<tr id="a0000000821">
    <td>&nbsp;</td>
    
    
        <td style="width:2.467em; vertical-align:baseline; text-align:right"><img src="images/img-0151.png" alt="$\displaystyle  L(\mathbf{u})  $" style="position:relative; bottom:49.0px; width:37px; height:18px" class="math" /></td>
    
    
    
        <td style="width:0.800em; vertical-align:baseline; text-align:center"><img src="images/img-0152.png" alt="$\displaystyle  =  $" style="position:relative; bottom:55.0px; width:12px; height:4px" class="math" /></td>
    
    
    
        <td style="width:16.867em; vertical-align:baseline; text-align:left"><img src="images/img-0153.png" alt="$\displaystyle  L(\mathbf{u}^0) + \underbrace{ \sum _{i=0}^{n_\mathrm {u}-1} \left( u_ i - u^0_ i \right) \left.\frac{\partial L}{\partial u_ i}\right|_{\mathbf{u}^0} }_{\textrm{Zero at $\mathbf{u}^0$ by definition}} + \label{L_ taylor_ expand} $" style="position:relative; bottom:0.0px; width:253px; height:85px" class="math" /></td>
    
    
    <td>&nbsp;</td>
    <td class="eqnnum"><span>(<span>D.4</span>)</span></td>
</tr><tr id="a0000000822">
    <td>&nbsp;</td>
    
    
        <td style="width:0.067em; vertical-align:baseline; text-align:right"><img src="images/img-0154.png" alt="$\displaystyle  $" style="position:relative; bottom:25.0px; width:1px; height:1px" class="math" /></td>
    
    
    
        <td style="width:0.067em; vertical-align:baseline; text-align:center"><img src="images/img-0154.png" alt="$\displaystyle  $" style="position:relative; bottom:25.0px; width:1px; height:1px" class="math" /></td>
    
    
    
        <td style="width:29.267em; vertical-align:baseline; text-align:left"><img src="images/img-0155.png" alt="$\displaystyle  \sum _{i=0}^{n_\mathrm {u}-1} \sum _{j=0}^{n_\mathrm {u}-1} \frac{\left( u_ i - u^0_ i \right) \left( u_ j - u^0_ j \right)}{2} \left.\frac{\partial ^2 L}{\partial u_ i \partial u_ j}\right|_{\mathbf{u}^0} + \mathcal{O}\left( \mathbf{u} - \mathbf{u}^0\right)^3 \nonumber  $" style="position:relative; bottom:0.0px; width:439px; height:65px" class="math" /></td>
    
    
    <td>&nbsp;</td>
    <td class="eqnnum">&nbsp;</td>
</tr>
</table><p>Since the logarithm of a Gaussian distribution is a parabola, the quadratic terms in the above expansion encode the Gaussian component of the probability distribution <img src="images/img-0141.png" alt="$\mathrm{P}\left( \mathbf{u} | \left\{  \mathbf{x}_ i, f_ i, \sigma _ i \right\}  \right)$" style="position:relative; bottom:-5px; width:130px; height:19px" class="math" /> about <img src="images/img-0149.png" alt="$\mathbf{u}^0$" style="position:relative; bottom:0px; width:19px; height:16px" class="math" />.<a class="footnote"><sup class="footnotemark">†</sup><span class="footnotetext">The use of this is called <i class="itshape">Gauss’ Method</i>. Higher order terms in the expansion represent any non-Gaussianity in the probability distribution, which we neglect. See MacKay, D.J.C., <i class="itshape">Information Theory, Inference and Learning Algorithms</i>, CUP (2003).</span></a> We may write the sum of these terms, which we denote <img src="images/img-0156.png" alt="$Q$" style="position:relative; bottom:-4px; width:14px; height:16px" class="math" />, in matrix form: </p><table id="&lt;plasTeX.TeXFragment object at 0x36bbf58&gt;" class="equation" width="100%">
<tr>
<td>
<img src="images/img-0157.png" alt="\begin{equation}  Q = \frac{1}{2} \left(\mathbf{u} - \mathbf{u}^0\right)^\mathbf {T} \mathbf{A} \left(\mathbf{u} - \mathbf{u}^0\right) \label{Q_ vector} \end{equation}" style="width:412px; height:37px" />
<td class="eqnnum"><span>(<span>D.5</span>)</span></td>
</tr>
</table><p>where the superscript <img src="images/img-0158.png" alt="$^\mathbf {T}$" style="position:relative; bottom:7px; width:11px; height:9px" class="math" /> represents the transpose of the vector displacement from <img src="images/img-0149.png" alt="$\mathbf{u}^0$" style="position:relative; bottom:0px; width:19px; height:16px" class="math" />, and <img src="images/img-0159.png" alt="$\mathbf{A}$" style="position:relative; bottom:0px; width:15px; height:12px" class="math" /> is the Hessian matrix of <img src="images/img-0146.png" alt="$L$" style="position:relative; bottom:0px; width:12px; height:12px" class="math" />, given by: </p><table id="a0000000823" class="equation" width="100%">
<tr>
<td>
<img src="images/img-0160.png" alt="\begin{equation}  A_{ij} = \nabla \nabla L = \left.\frac{\partial ^2 L}{\partial u_ i \partial u_ j}\right|_{\mathbf{u}^0} \end{equation}" style="width:398px; height:46px" />
<td class="eqnnum"><span>(<span>D.6</span>)</span></td>
</tr>
</table><p> <span id="a0000000824"></span> </p><p>This is the Hessian matrix which is output by the <tt class="tt">fit</tt> command. In general, an <img src="images/img-0137.png" alt="$n_\mathrm {u}$" style="position:relative; bottom:-2px; width:19px; height:10px" class="math" />-dimensional Gaussian distribution such as that given by equation (<a></a>) yields elliptical contours of equiprobability in parameter space, whose principal axes need not be aligned with our chosen co-ordinate axes – the variables <img src="images/img-0161.png" alt="$u_0 ... u_{n_ u-1}$" style="position:relative; bottom:-4px; width:78px; height:12px" class="math" />. The eigenvectors <img src="images/img-0162.png" alt="$\mathbf{e}_ i$" style="position:relative; bottom:-2px; width:15px; height:10px" class="math" /> of <img src="images/img-0159.png" alt="$\mathbf{A}$" style="position:relative; bottom:0px; width:15px; height:12px" class="math" /> are the principal axes of these ellipses, and the corresponding eigenvalues <img src="images/img-0163.png" alt="$\lambda _ i$" style="position:relative; bottom:-2px; width:15px; height:15px" class="math" /> equal <img src="images/img-0164.png" alt="$1/\sigma _ i^2$" style="position:relative; bottom:-5px; width:36px; height:21px" class="math" />, where <img src="images/img-0135.png" alt="$\sigma _ i$" style="position:relative; bottom:-2px; width:15px; height:10px" class="math" /> is the standard deviation of the probability density function along the direction of these axes. </p><p>This can be visualised by imagining that we diagonalise <img src="images/img-0159.png" alt="$\mathbf{A}$" style="position:relative; bottom:0px; width:15px; height:12px" class="math" />, and expand equation (<a></a>) in our diagonal basis. The resulting expression for <img src="images/img-0146.png" alt="$L$" style="position:relative; bottom:0px; width:12px; height:12px" class="math" /> is a sum of square terms; the cross terms vanish in this basis by definition. The equations of the equiprobability contours become the equations of ellipses: </p><table id="a0000000825" class="equation" width="100%">
<tr>
<td>
<img src="images/img-0165.png" alt="\begin{equation}  Q = \frac{1}{2} \sum _{i=0}^{n_\mathrm {u}-1} A_{ii} \left(u_ i - u^0_ i\right)^2 = k \end{equation}" style="width:415px; height:53px" />
<td class="eqnnum"><span>(<span>D.7</span>)</span></td>
</tr>
</table><p>where <img src="images/img-0148.png" alt="$k$" style="position:relative; bottom:0px; width:9px; height:13px" class="math" /> is some constant. By comparison with the equation for the logarithm of a Gaussian distribution, we can associate <img src="images/img-0166.png" alt="$A_{ii}$" style="position:relative; bottom:-2px; width:24px; height:14px" class="math" /> with <img src="images/img-0167.png" alt="$-1/\sigma _ i^2$" style="position:relative; bottom:-5px; width:49px; height:21px" class="math" /> in our eigenvector basis. </p><p>The problem of evaluating the standard deviations of our variables <img src="images/img-0168.png" alt="$u_ i$" style="position:relative; bottom:-2px; width:15px; height:10px" class="math" /> is more complicated, however, as we are attempting to evaluate the width of these elliptical equiprobability contours in directions which are, in general, not aligned with their principal axes. To achieve this, we first convert our Hessian matrix into a covariance matrix. </p></div>



<div class="navigation">
<table cellspacing="2" cellpadding="0" width="100%">
<tr>
<td><a href="bayes_pdf.html" title="The Probability Density Function"><img alt="Previous: The Probability Density Function" border="0" src="icons/previous.gif" width="32" height="32" /></a></td>

<td><a href="fit_math.html" title="The fit Command: Mathematical Details"><img alt="Up: The fit Command: Mathematical Details" border="0" src="icons/up.gif" width="32" height="32" /></a></td>

<td><a href="sect0153.html" title="The Covariance Matrix"><img alt="Next: The Covariance Matrix" border="0" src="icons/next.gif" width="32" height="32" /></a></td>

<td class="navtitle" align="center">&nbsp;</td>
<td><a href="index.html" title="Table of Contents"><img border="0" alt="" src="icons/contents.gif" width="32" height="32" /></a></td>

<td><a href="sect0158.html" title="Index"><img border="0" alt="" src="icons/index.gif" width="32" height="32" /></a></td>

<td><img border="0" alt="" src="icons/blank.gif" width="32" height="32" /></td>
</tr>
</table>
</div>

<script language="javascript" src="icons/imgadjust.js" type="text/javascript"></script>

</body>
</html>
